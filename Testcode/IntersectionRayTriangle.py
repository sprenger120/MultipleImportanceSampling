


import numpy as np
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d.art3d import Poly3DCollection





fig = plt.figure(figsize=plt.figaspect(0.5)*1.5)
ax = fig.add_subplot(111, projection='3d')
ax.set_aspect('equal',)
ax.set_xlim( -3.1, 3.1)
ax.set_ylim( -3.1, 3.1)
ax.set_zlim( -3.1, 3.1)
ax.grid(False)
for a in (ax.w_xaxis, ax.w_yaxis, ax.w_zaxis):
    for t in a.get_ticklines()+a.get_ticklabels():
        t.set_visible(False)
    a.line.set_visible(False)
    a.pane.set_visible(False)

"""
omegasr3 = s2tor3array( omegas)


for n in range(N):
    omegasr3[n] = np.dot(roateMatrix, omegasr3[n])




soa = np.zeros((2,6))
soa[0,:] = [0, 0, 0,  defaultNormal[0], defaultNormal[1], defaultNormal[2]]
soa[1,:] = [0, 0, 0,  alteredNormal[0], alteredNormal[1], alteredNormal[2]]

X, Y, Z, U, V, W = zip(*soa)

ax.quiver(X, Y, Z, U, V, W, color=[[0,0,1],[0,1,0]], pivot="tail")


ax.scatter(0, 0, 0, c=[[1,0,0]])
ax.scatter( omegasr3[:,0], omegasr3[:,1], omegasr3[:,2])


"""

"""
correct triggering: 
d = [ 0.00193304  0.14304465  0.98971435]
t = 14.1441143822
n  = [-0.30151134  0.30151134 -0.90453403]



generated rays

o=  [ 0.02734108  2.02323992  3.99863295]  d= [-0.13667557 -1.08559515 -4.32858486]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [-0.39227911 -2.07612522 -4.92816152]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [-0.16634488 -1.92387365 -4.98392696]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [-0.40281193 -1.41116136 -4.69460814]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [-0.04292561 -1.96198768 -4.99663359]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [-0.11325067 -1.02895452 -3.93526034]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [-0.28661593 -1.48604785 -4.80125442]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [ 0.67336891 -2.49277461 -4.53579464]  t= 10000.0
o=  [ 0.02734108  2.02323992  3.99863295]  d= [ 0.08818078 -2.25290328 -4.96502285]  t= 10000.0


"""

#triangle
a = np.array([3.0,5.0,4.0])
b = np.array([3.0,2.0,3.0])
c = np.array([0.0,2.0,4.0])

# draw vectors
t = 15
d = np.array([0.87527062 , 2.55284903,  3.97561798])
o = np.array([0.02734108 , 2.02323992 , 3.99863295])

normal = np.array([-0.30151134 , 0.30151134, -0.90453403])

ab = b -a
ac = c - a
##normal = np.cross(ab,ac)
#normal = normal / np.linalg.norm(normal)


d *= t
p = o + d


soa = np.zeros((101,6))
soa[ 0 ,:] =[ 0 , 0 , -10 , 0.00772539143845 , 0.14871378519 , 0.988850104122 ]
soa[ 1 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.0965876344808 , 0.326562070348 , -0.940227654919 ]
soa[ 2 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.982614233488 , 0.0111908511568 , -0.185321431566 ]
soa[ 3 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.891445746605 , 0.272053321924 , -0.362369246612 ]
soa[ 4 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.122331656493 , -0.468311539324 , -0.875053865745 ]
soa[ 5 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.141215483754 , 0.395381447573 , -0.907596660452 ]
soa[ 6 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.751296872185 , -0.391515974952 , -0.531289234978 ]
soa[ 7 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.136626357123 , 0.988151442884 , 0.0699282808754 ]
soa[ 8 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.382796888644 , 0.534269030824 , -0.753673102046 ]
soa[ 9 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.997712513974 , 0.0614388857458 , -0.0281957936354 ]
soa[ 10 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.314457704173 , -0.385952585581 , -0.86726982766 ]
soa[ 11 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.696703847675 , 0.0609681516352 , -0.714763340638 ]
soa[ 12 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.416498176919 , -0.867305758822 , -0.272598586455 ]
soa[ 13 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.233191134705 , 0.168943180716 , -0.957642990046 ]
soa[ 14 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.115789422332 , 0.661581678209 , -0.740879539962 ]
soa[ 15 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.0369106735059 , 0.112361832186 , -0.992981581324 ]
soa[ 16 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.410236938093 , -0.00111382981123 , -0.911978296895 ]
soa[ 17 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.795337703729 , 0.0564486483099 , -0.603532507104 ]
soa[ 18 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.760324692558 , -0.0983020047092 , -0.642061584085 ]
soa[ 19 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.398843338123 , -0.12377492558 , -0.908627404073 ]
soa[ 20 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.704500399409 , -0.691466583479 , -0.15985353035 ]
soa[ 21 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.126917630286 , 0.526956894641 , -0.840362032884 ]
soa[ 22 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.0529244424355 , -0.676211412713 , -0.734804143095 ]
soa[ 23 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.79169246743 , -0.584205305992 , -0.178681833059 ]
soa[ 24 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.325631868923 , 0.940371179378 , 0.0983154664212 ]
soa[ 25 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.299461670581 , 0.921533961673 , -0.247179823885 ]
soa[ 26 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.313808963615 , 0.644691049938 , -0.697063400621 ]
soa[ 27 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.103172995803 , 0.991103929642 , -0.0840733821419 ]
soa[ 28 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.190037994377 , 0.945385916702 , -0.264822637239 ]
soa[ 29 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.725644947207 , 0.206446768425 , -0.656368145479 ]
soa[ 30 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.225410371195 , -0.0156906981925 , -0.974137550117 ]
soa[ 31 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.169745449302 , 0.450521309107 , -0.876479909913 ]
soa[ 32 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.174089129755 , 0.947352403614 , -0.268731089137 ]
soa[ 33 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.641036056738 , 0.681400037868 , -0.353223388744 ]
soa[ 34 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.344057378712 , 0.916928591758 , -0.202154588796 ]
soa[ 35 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.134464098152 , 0.0543062323671 , -0.989429249332 ]
soa[ 36 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.987745856265 , 0.0685449855777 , -0.140213082073 ]
soa[ 37 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.597630516616 , -0.217453880611 , -0.771719881445 ]
soa[ 38 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.175066898002 , 0.960937161028 , 0.214362668811 ]
soa[ 39 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.0359003772163 , 0.950530646828 , -0.308549270549 ]
soa[ 40 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.365302182716 , 0.85164317687 , -0.375843337833 ]
soa[ 41 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.211700916284 , 0.156524213422 , -0.964719074476 ]
soa[ 42 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.443601207549 , -0.248924798286 , -0.86096133099 ]
soa[ 43 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.0613544280579 , -0.479289609943 , -0.87550962528 ]
soa[ 44 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.0283344229927 , 0.169126069607 , -0.985187054855 ]
soa[ 45 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.628811104265 , 0.0602658854193 , -0.775219077557 ]
soa[ 46 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.420501897419 , -0.2166299029 , -0.881050304714 ]
soa[ 47 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.512324637963 , -0.323319382544 , -0.795605456371 ]
soa[ 48 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.590581720594 , -0.349424762117 , -0.727403304172 ]
soa[ 49 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.497843871087 , 0.852366706996 , -0.160070224668 ]
soa[ 50 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.706636826384 , -0.0340805538536 , -0.706755199094 ]
soa[ 51 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.513300007282 , 0.781666061966 , -0.354289810883 ]
soa[ 52 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.0423571223747 , 0.265859341666 , -0.963080829751 ]
soa[ 53 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.914974312007 , 0.375124950298 , 0.148671719002 ]
soa[ 54 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.529306729558 , -0.50871913141 , -0.678998697629 ]
soa[ 55 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.0687542238054 , -0.0158531730234 , -0.99750766093 ]
soa[ 56 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.856353773874 , 0.507323852234 , 0.096336508789 ]
soa[ 57 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.726528632832 , 0.339367227305 , -0.59748307985 ]
soa[ 58 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.133897683762 , 0.172897919992 , -0.97579594155 ]
soa[ 59 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.385555347089 , -0.798454717518 , -0.462403653104 ]
soa[ 60 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.125415550084 , 0.113271965544 , -0.985616762042 ]
soa[ 61 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.495478206618 , 0.639066594106 , -0.588298593458 ]
soa[ 62 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.176475015198 , 0.22066594609 , -0.959251327467 ]
soa[ 63 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.786074765823 , 0.352295203249 , -0.507911953299 ]
soa[ 64 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.0762416280817 , -0.00764395173555 , -0.997060070482 ]
soa[ 65 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.520999988028 , -0.376301595463 , -0.766130616623 ]
soa[ 66 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.604356402329 , 0.69022355688 , -0.39792559668 ]
soa[ 67 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.307105533954 , -0.823158596905 , -0.477594090579 ]
soa[ 68 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.172257230615 , 0.230295022085 , -0.95775343868 ]
soa[ 69 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.209737767034 , 0.0354306370166 , -0.977115519803 ]
soa[ 70 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.807741036684 , -0.10487061977 , -0.580134959096 ]
soa[ 71 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.847010555363 , -0.148424344907 , -0.51043445509 ]
soa[ 72 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.45960091557 , 0.34331378061 , -0.81908647068 ]
soa[ 73 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.209002483934 , 0.294868999308 , -0.932400254696 ]
soa[ 74 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.86568231749 , 0.148506774543 , -0.478058430635 ]
soa[ 75 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.656840092035 , 0.752216423272 , 0.0522641947686 ]
soa[ 76 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.044386965205 , -0.0246624785607 , -0.998709947618 ]
soa[ 77 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.384478087638 , -0.763547022909 , -0.518818411328 ]
soa[ 78 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.294592123437 , 0.599777986347 , -0.743963606571 ]
soa[ 79 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.614357996435 , 0.0490560547598 , -0.787500956005 ]
soa[ 80 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.47770125242 , -0.385158027507 , -0.789591544587 ]
soa[ 81 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.440431018474 , 0.187947556135 , -0.877893065304 ]
soa[ 82 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.91434830703 , 0.0160867563058 , -0.404608934285 ]
soa[ 83 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.961744927729 , -0.235196260665 , -0.140461428712 ]
soa[ 84 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.355558321131 , 0.776030968242 , -0.520916707933 ]
soa[ 85 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.31107413586 , 0.0145151634009 , -0.950274798166 ]
soa[ 86 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.874398231825 , 0.0987860451668 , -0.475046365591 ]
soa[ 87 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.468083583979 , -0.33833989971 , -0.816347885815 ]
soa[ 88 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.536556287424 , -0.603267945031 , -0.590063671923 ]
soa[ 89 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.41205078809 , -0.386557986679 , -0.825098218983 ]
soa[ 90 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.495688050944 , 0.489491419411 , -0.717420034899 ]
soa[ 91 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.269847953217 , 0.286426480739 , -0.919316024703 ]
soa[ 92 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.697120883966 , -0.00146446480618 , -0.716952110312 ]
soa[ 93 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.438749706329 , -0.498326730015 , -0.74777614655 ]
soa[ 94 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , -0.201492731392 , 0.280829202988 , -0.938368604518 ]
soa[ 95 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.0631533971245 , -0.697549091995 , -0.713748494001 ]
soa[ 96 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.0451979151625 , 0.521125347105 , -0.852282535941 ]
soa[ 97 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.85506853221 , 0.495387938751 , -0.153129341946 ]
soa[ 98 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.818290871165 , -0.253761975008 , -0.51575663855 ]
soa[ 99 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.0158710135527 , 0.0040593994053 , -0.999865807099 ]
soa[ 100 ,:] =[ 0.109364319891 , 2.10526315789 , 3.998632946 , 0.847941899208 , 0.378559220935 , -0.371062598239 ]

#soa[0,:] = [o[0], o[1], o[2],  d[0], d[1], d[2]]
#soa[1,:] = [p[0], p[1], p[2],  normal[0], normal[1], normal[2]]
#soa[1,:] = [a[0], a[1], a[2],  normal[0], normal[1], normal[2]]

X, Y, Z, U, V, W = zip(*soa)

ax.quiver(X, Y, Z, U, V, W, color=[[0,0,1],[0,1,0]], pivot="tail", length=t)

ax.scatter(p[0],p[1],p[2], c=[[1,0,0]])



ax.add_collection3d(Poly3DCollection([[a,b,c]]))

ax.set_xlabel('X........................')
ax.set_ylabel('Y........................')
ax.set_zlabel('Z........................')
plt.show()